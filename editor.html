<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>글쓰기 · Ha-Bin Studio</title>

  <!-- 사이트 공통 스타일 -->
  <link rel="stylesheet" href="style.css">

  <!-- 에디터 전용 스타일 -->
  <link rel="stylesheet" href="editor.css">

  <!-- 이미지 핸들 스타일 -->
  <link rel="stylesheet" href="image.css">

  <!-- 폰트 -->
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Nanum+Myeongjo&family=Noto+Serif+KR:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    @font-face {
      font-family: 'HCR Batang';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2101@1.1/HanBatang.woff') format('woff');
      font-weight: normal;
      font-style: normal;
    }
  </style>
</head>

<body>

<script src="secret-gate.js"></script>

<div class="editor-container">

  <!-- 제목 -->
  <input type="text" id="post-title" placeholder="제목을 입력하세요">

  <!-- 공지 + 상단 버튼 -->
  <div class="notice-line">
    <div class="notice-area">
      <input type="checkbox" id="notice-check">
      <label for="notice-check">📌 공지글로 등록하기</label>
    </div>

    <div class="editor-buttons">
      <button class="editor-btn btn-cancel" id="cancelBtn">취소</button>
      <button class="editor-btn btn-save"   id="saveBtn">등록</button>
      <button class="editor-btn btn-save"   id="updateBtn">수정</button>
      <button class="editor-btn btn-delete" id="deleteBtn">삭제</button>
    </div>
  </div>
<!-- 🎨 Ha-Bin Studio · Ribbon Toolbar v5.0 -->
<div id="hb-toolbar" class="hb-toolbar">

  <!-- 📁 글꼴 그룹 -->
  <div class="hb-group">
    <select id="hb-font-family" class="hb-select" title="글꼴">
      <option value="">글꼴</option>
      <option value="Noto Sans KR">Noto Sans KR</option>
      <option value="HCR Batang">함초롱바탕</option>
      <option value="Gowun Dodum">고운돋움</option>
      <option value="Nanum Myeongjo">나눔명조</option>
    </select>

    <select id="hb-font-size" class="hb-select" title="크기">
      <option value="">크기</option>
      <option value="13px">13px</option>
      <option value="15px">15px</option>
      <option value="16px">16px</option>
      <option value="17px">17px</option>
      <option value="18px">18px</option>
      <option value="20px">20px</option>
      <option value="22px">22px</option>
      <option value="24px">24px</option>
      <option value="28px">28px</option>
      <option value="32px">32px</option>
    </select>

    <button class="hb-btn" data-cmd="bold"><b>B</b></button>
    <button class="hb-btn" data-cmd="italic"><i>I</i></button>
    <button class="hb-btn" data-cmd="underline"><u>U</u></button>
  </div>

  <!-- 🎨 색상 그룹 -->
  <div class="hb-group">
    <button id="hb-color-text" class="hb-btn hb-color-btn">🖌A</button>
    <button id="hb-color-bg" class="hb-btn hb-color-btn">🎨</button>
  </div>

  <!-- 📐 정렬 그룹 -->
  <div class="hb-group">
    <button class="hb-btn" data-align="left">좌</button>
    <button class="hb-btn" data-align="center">중</button>
    <button class="hb-btn" data-align="right">우</button>
    <button class="hb-btn" data-align="justify">양</button>

    <select id="hb-line-height" class="hb-select" title="줄간격">
      <option value="">줄간격</option>
      <option value="1.4">1.4</option>
      <option value="1.6">1.6</option>
      <option value="1.8">1.8</option>
      <option value="2.0">2.0</option>
      <option value="2.2">2.2</option>
    </select>

    <button class="hb-btn" id="hb-indent">▶</button>
    <button class="hb-btn" id="hb-outdent">◀</button>
  </div>

  <!-- 📑 목록/스타일 그룹 -->
  <div class="hb-group">
    <button class="hb-btn" data-cmd="insertUnorderedList">• 목록</button>
    <button class="hb-btn" data-cmd="insertOrderedList">1. 목록</button>

    <button class="hb-btn" id="hb-quote">❝ 인용</button>
    <button class="hb-btn" id="hb-code">⌘ 코드</button>
  </div>

  <!-- 🖼 이미지/편집 그룹 -->
  <div class="hb-group">
    <button class="hb-btn" id="hb-image">🌈⚒</button>

    <button class="hb-btn" data-cmd="undo">↺</button>
    <button class="hb-btn" data-cmd="redo">↻</button>

    <button class="hb-btn" id="hb-clear-style">서식 지우기</button>
    <button class="hb-btn" id="hb-clear-all">전체 삭제</button>
  </div>

</div>

<!-- 🎨 Excel Color Popup (필수) -->
<div id="hb-color-popup" class="hb-color-popup" style="display:none;">
  <div class="popup-title">테마 색</div>
  <div class="theme-grid"></div>

  <div class="popup-title" style="margin-top:6px;">표준 색</div>
  <div class="standard-grid"></div>

  <div class="more-color-area">
    <button id="hb-more-color">다른 색…</button>
  </div>
</div>

<!-- 🎨 고급 컬러 선택기 (HEX + Color Picker) -->
<div id="hb-advanced-color" class="hb-advanced-color" style="display:none;">
  <div class="adv-title">고급 색상 선택</div>

  <input type="color" id="hb-color-picker">
  <input type="text" id="hb-hex-input" placeholder="#000000">

  <div class="adv-buttons">
    <button id="hb-adv-apply">적용</button>
    <button id="hb-adv-cancel">취소</button>
  </div>

  <!-- 본문 -->
  <div id="editor" contenteditable="true"></div>

  <!-- 하단 목록/메인 -->
  <div class="notice-buttons">
    <a href="list.html"  class="btn-top">목록</a>
    <a href="index.html" class="btn-top">메인</a>
  </div>

</div>

<!-- 엔진 4대 모듈 -->
<script src="color.js"></script>
<script src="toolbar.js"></script>
<script src="image.js"></script>

<script>
/* ---------------------------------------------
   📌 localStorage 기반 글 저장/수정/삭제
---------------------------------------------- */
let posts = JSON.parse(localStorage.getItem("habin_posts") || "[]");
const params = new URLSearchParams(window.location.search);
const editId = params.get("id");

/* 수정 모드일 때 기존 글 불러오기 */
if (editId) {
  const post = posts.find(p => String(p.id) === String(editId));
  if (post) {
    document.getElementById("post-title").value = post.title || "";
    document.getElementById("editor").innerHTML = post.content || "";
    document.getElementById("notice-check").checked = !!post.isNotice;
  }
}

/* 등록/수정 */
function saveOrUpdate() {
  const title   = document.getElementById("post-title").value.trim();
  const content = document.getElementById("editor").innerHTML.trim();
  const isNotice = document.getElementById("notice-check").checked;

  if (!title) {
    alert("제목을 입력하세요.");
    return;
  }

  const now = new Date();
  const d = `${now.getFullYear()}-${now.getMonth()+1}-${now.getDate()} ` +
            `${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`;

  if (editId) {
    const post = posts.find(p => String(p.id) === String(editId));
    if (post) {
      post.title   = title;
      post.content = content;
      post.date    = d;
      post.isNotice = isNotice;
    }
  } else {
    posts.push({
      id: Date.now(),
      title,
      content,
      writer: "하빈",
      date: d,
      isNotice
    });
  }

  localStorage.setItem("habin_posts", JSON.stringify(posts));
  location.href = "list.html";
}

document.getElementById("saveBtn").onclick   = saveOrUpdate;
document.getElementById("updateBtn").onclick = saveOrUpdate;

/* 삭제 */
document.getElementById("deleteBtn").onclick = () => {
  if (!editId) return;
  if (!confirm("삭제하시겠습니까?")) return;

  posts = posts.filter(p => String(p.id) !== String(editId));
  localStorage.setItem("habin_posts", JSON.stringify(posts));
  location.href = "list.html";
};

/* 취소 */
document.getElementById("cancelBtn").onclick = () => history.back();
</script>

</body>
</html>



