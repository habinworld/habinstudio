<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê¸€ì“°ê¸° Â· Ha-Bin Studio</title>

  <!-- ë©”ì¸ ì‚¬ì´íŠ¸ ìŠ¤íƒ€ì¼ (ìˆìœ¼ë©´ ìœ ì§€) -->
  <link rel="stylesheet" href="style.css">
  <!-- ì—ë””í„° ì „ìš© ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="editor.css">
  <!-- ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì¦ˆ ì „ìš© ìŠ¤íƒ€ì¼  -->
<link rel="stylesheet" href="image.css">
  <!-- í°íŠ¸ ë¡œë”© -->
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Nanum+Myeongjo&family=Noto+Serif+KR:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    /* ---------------------- ì „ì²´ ë˜í¼ ---------------------- */
    .editor-container {
      max-width: 900px;
      margin: 30px auto 120px;
      padding: 0 20px;
    }

    /* ---------------------- ì œëª© ì…ë ¥ ----------------------- */
    #post-title {
      width: 100%;
      padding: 14px 16px;
      font-size: 22px;
      font-weight: 700;
      border: 2px solid #ddd;
      border-radius: 8px;
      margin-bottom: 12px;
      box-sizing: border-box;
    }
    #post-title:focus {
      border-color: #3558A8;
      box-shadow: 0 0 0 3px rgba(92,142,219,0.25);
      outline: none;
    }

    /* ---------------------- ê³µì§€ + ìƒë‹¨ ë²„íŠ¼ ì¤„ ---------------------- */
    .notice-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 14px;
      flex-wrap: wrap;
    }

    .notice-area {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 15px;
    }

    .notice-area label {
      font-weight: 600;
    }

    /* ìƒë‹¨ ì˜¤ë¥¸ìª½ ë²„íŠ¼ (ì·¨ì†Œ/ë“±ë¡/ìˆ˜ì •/ì‚­ì œ) */
    .editor-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: flex-end;
    }

    .editor-btn {
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      height: 35px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border: none;
    }

    .btn-cancel { background: #CCCCCC; color: #000; }
    .btn-cancel:hover { background: #BBBBBB; }

    .btn-save { background: #3558A8; color: #FFFFFF; }
    .btn-save:hover { background: #5C8EDB; }

    .btn-delete { background: #D9534F; color: #FFFFFF; }
    .btn-delete:hover { background: #C3413B; }

    /* í•˜ë‹¨ ëª©ë¡/ë©”ì¸ ë²„íŠ¼ */
    .notice-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      margin-top: 18px;
      flex-wrap: wrap;
    }

    .btn-top {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 6px 12px;
      background: #3558A8;
      color: #FFFFFF;
      border-radius: 6px;
      font-size: 15px;
      font-weight: 600;
      text-decoration: none;
      height: 35px;
      line-height: 1;
    }
    .btn-top:hover {
      opacity: 0.92;
    }

    @media (max-width: 600px) {
      .notice-line {
        flex-direction: column;
        align-items: flex-start;
      }
      .editor-buttons {
        width: 100%;
        justify-content: flex-start;
      }
      .notice-buttons {
        justify-content: center;
      }
    }
  </style>
</head>

<body>

<script src="secret-gate.js"></script>

<div class="editor-container">

  <!-- ì œëª© -->
  <input type="text" id="post-title" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">

  <!-- ê³µì§€ + ìƒë‹¨ ë²„íŠ¼ -->
  <div class="notice-line">
    <div class="notice-area">
      <input type="checkbox" id="notice-check">
      <label for="notice-check">ğŸ“Œ ê³µì§€ê¸€ë¡œ ë“±ë¡í•˜ê¸°</label>
    </div>

    <div class="editor-buttons">
      <button class="editor-btn btn-cancel" id="cancelBtn">ì·¨ì†Œ</button>
      <button class="editor-btn btn-save"   id="saveBtn">ë“±ë¡</button>
      <button class="editor-btn btn-save"   id="updateBtn">ìˆ˜ì •</button>
      <button class="editor-btn btn-delete" id="deleteBtn">ì‚­ì œ</button>
    </div>
  </div>

  <!-- Ribbon Toolbar (ë“œë¡­ë‹¤ìš´ + ë²„íŠ¼ ìë™ ìƒì„±) -->
  <div id="toolbar">
    <!-- ë“œë¡­ë‹¤ìš´ 3ì¢…: ì˜µì…˜ì€ toolbar.jsì—ì„œ ì±„ì›€ -->
    <select id="fontFamilySelect" title="ê¸€ê¼´ ì„ íƒ">
      <option value="">ê¸€ìì²´</option>
    </select>

    <select id="fontSizeSelect" title="ê¸€ì í¬ê¸°">
      <option value="">í¬ê¸°</option>
    </select>

    <select id="lineHeightSelect" title="ì¤„ê°„ê²©">
      <option value="">ì¤„ê°„ê²©</option>
    </select>
    <!-- ë‚˜ë¨¸ì§€ ë²„íŠ¼ë“¤(êµµê²Œ/ê¸°ìš¸ì„/ìƒ‰ìƒ/ì´ë¯¸ì§€ ë“±)ì€ toolbar.jsì—ì„œ ë™ì ìœ¼ë¡œ ì¶”ê°€ -->
  </div>

  <!-- ë³¸ë¬¸ ì—ë””í„° -->
  <div id="editor" contenteditable="true"><p><br></p></div>

  <!-- í•˜ë‹¨ ëª©ë¡/ë©”ì¸ ë²„íŠ¼ -->
  <div class="notice-buttons">
    <a href="list.html"  class="btn-top">ëª©ë¡</a>
    <a href="index.html" class="btn-top">ë©”ì¸</a>
  </div>

</div>

<!-- ì‹¬ì¥ 3ëŒ€ ì—”ì§„: ìˆœì„œ ì¤‘ìš”X (ëª¨ë‘ DOMContentLoaded ì‚¬ìš©) -->
<script src="color.js"></script>
<script src="toolbar.js"></script>
<script src="image.js"></script>

<script>
/* -----------------------------------------------------
   ğŸ“Œ localStorage ê¸°ë°˜ ê¸€ ì €ì¥/ìˆ˜ì •/ì‚­ì œ
----------------------------------------------------- */
let posts = JSON.parse(localStorage.getItem("habin_posts") || "[]");

const params = new URLSearchParams(window.location.search);
const editId = params.get("id");

/* ìˆ˜ì • ëª¨ë“œì¼ ê²½ìš° ê¸°ì¡´ ë°ì´í„° ì±„ìš°ê¸° */
if (editId) {
  const post = posts.find(p => String(p.id) === String(editId));
  if (post) {
    document.getElementById("post-title").value = post.title || "";
    document.getElementById("editor").innerHTML = post.content || "";
    document.getElementById("notice-check").checked = !!post.isNotice;
  }
}

/* -----------------------------------------------------
   ğŸ“Œ ë“±ë¡ / ìˆ˜ì • (ê°™ì€ ë¡œì§ ì‚¬ìš©)
----------------------------------------------------- */
const saveBtn   = document.getElementById("saveBtn");
const updateBtn = document.getElementById("updateBtn");

function saveOrUpdate() {
  const title   = document.getElementById("post-title").value.trim();
  const content = document.getElementById("editor").innerHTML.trim();
  const isNotice = document.getElementById("notice-check").checked;

  if (!title) {
    alert("ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.");
    return;
  }

  const now = new Date();
  const date = `${now.getFullYear()}-${now.getMonth()+1}-${now.getDate()} ` +
               `${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`;

  if (editId) {
    // ìˆ˜ì • ëª¨ë“œ
    const post = posts.find(p => String(p.id) === String(editId));
    if (post) {
      post.title   = title;
      post.content = content;
      post.date    = date;
      post.isNotice = isNotice;
    }
  } else {
    // ìƒˆ ê¸€
    posts.push({
      id: Date.now(),
      title,
      content,
      writer: "í•˜ë¹ˆ",
      date,
      isNotice
    });
  }

  localStorage.setItem("habin_posts", JSON.stringify(posts));
  location.href = "list.html";
}

saveBtn.onclick   = saveOrUpdate;
updateBtn.onclick = saveOrUpdate;

/* -----------------------------------------------------
   ğŸ“Œ ì‚­ì œ
----------------------------------------------------- */
document.getElementById("deleteBtn").onclick = () => {
  if (!editId) return;
  if (!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

  posts = posts.filter(p => String(p.id) !== String(editId));
  localStorage.setItem("habin_posts", JSON.stringify(posts));
  location.href = "list.html";
};

/* -----------------------------------------------------
   ğŸ“Œ ì·¨ì†Œ
----------------------------------------------------- */
document.getElementById("cancelBtn").onclick = () => {
  history.back();
};
</script>

</body>
</html>

