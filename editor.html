<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê¸€ì“°ê¸° Â· Ha-Bin Studio</title>

  <!-- ì‚¬ì´íŠ¸ ê³µí†µ ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="style.css">

  <!-- ì—ë””í„° ì „ìš© ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="editor.css">

  <!-- ì´ë¯¸ì§€ í•¸ë“¤ ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="image.css">

  <!-- í°íŠ¸ -->
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&family=Nanum+Myeongjo&family=Noto+Serif+KR:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    @font-face {
      font-family: 'HCR Batang';
      src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2101@1.1/HanBatang.woff') format('woff');
      font-weight: normal;
      font-style: normal;
    }
  </style>
</head>

<body>

<script src="secret-gate.js"></script>

<div class="editor-container">

  <!-- ì œëª© -->
  <input type="text" id="post-title" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">

  <!-- ê³µì§€ + ìƒë‹¨ ë²„íŠ¼ -->
  <div class="notice-line">
    <div class="notice-area">
      <input type="checkbox" id="notice-check">
      <label for="notice-check">ğŸ“Œ ê³µì§€ê¸€ë¡œ ë“±ë¡í•˜ê¸°</label>
    </div>

    <div class="editor-buttons">
      <button class="editor-btn btn-cancel" id="cancelBtn">ì·¨ì†Œ</button>
      <button class="editor-btn btn-save"   id="saveBtn">ë“±ë¡</button>
      <button class="editor-btn btn-save"   id="updateBtn">ìˆ˜ì •</button>
      <button class="editor-btn btn-delete" id="deleteBtn">ì‚­ì œ</button>
    </div>
  </div>

  <!-- ë¦¬ë³¸ íˆ´ë°” -->
  <div id="toolbar">

    <!-- ê¸€ìì²´ -->
    <select id="fontFamilySelect" title="ê¸€ê¼´ ì„ íƒ" onchange="hbSetFontFamily(this.value)">
      <option value="">ê¸€ìì²´</option>
      <option value="Noto Sans KR">Noto Sans KR</option>
      <option value="HCR Batang">í•¨ì´ˆë¡±ë°”íƒ•</option>
      <option value="Nanum Myeongjo">ë‚˜ëˆ”ëª…ì¡°</option>
      <option value="Gowun Dodum">ê³ ìš´ë‹ì›€</option>
    </select>

    <!-- ê¸€ì í¬ê¸° -->
    <select id="fontSizeSelect" title="ê¸€ì í¬ê¸°" onchange="hbSetFontSize(this.value)">
      <option value="">í¬ê¸°</option>
      <option value="13">13px</option>
      <option value="15">15px</option>
      <option value="16">16px</option>
      <option value="17">17px</option>
      <option value="18">18px</option>
      <option value="20">20px</option>
      <option value="22">22px</option>
      <option value="24">24px</option>
      <option value="28">28px</option>
      <option value="32">32px</option>
    </select>

    <!-- ì¤„ ê°„ê²© -->
    <select id="lineHeightSelect" title="ì¤„ê°„ê²©" onchange="hbSetLineHeight(this.value)">
      <option value="">ì¤„ê°„ê²©</option>
      <option value="1.4">1.4</option>
      <option value="1.6">1.6</option>
      <option value="1.8">1.8</option>
      <option value="2.0">2.0</option>
      <option value="2.2">2.2</option>
    </select>

    <!-- êµµê²Œ/ê¸°ìš¸ì„/ë°‘ì¤„ -->
    <button class="toolbar-btn" onclick="hbExec('bold')">B</button>
    <button class="toolbar-btn" onclick="hbExec('italic')"><i>I</i></button>
    <button class="toolbar-btn" onclick="hbExec('underline')"><u>U</u></button>

    <!-- ìƒ‰ìƒ -->
    <button class="toolbar-btn" id="textColorBtn" onclick="hbOpenColorPopup('color')">ê¸€ììƒ‰</button>
    <button class="toolbar-btn" id="bgColorBtn"   onclick="hbOpenColorPopup('background')">ë°°ê²½ìƒ‰</button>

    <!-- ì •ë ¬ -->
    <button class="toolbar-btn" onclick="hbExec('justifyLeft')">ì¢Œ</button>
    <button class="toolbar-btn" onclick="hbExec('justifyCenter')">ì¤‘</button>
    <button class="toolbar-btn" onclick="hbExec('justifyRight')">ìš°</button>

    <!-- ë¦¬ìŠ¤íŠ¸ -->
    <button class="toolbar-btn" onclick="hbExec('insertUnorderedList')">â€¢ ëª©ë¡</button>
    <button class="toolbar-btn" onclick="hbExec('insertOrderedList')">1. ëª©ë¡</button>

    <!-- ì´ë¯¸ì§€/ë§í¬/êµ¬ë¶„ì„  -->
    <button class="toolbar-btn" onclick="hbInsertImage()">ğŸ–¼</button>
    <button class="toolbar-btn" onclick="hbInsertLink()">ğŸ”—</button>
    <button class="toolbar-btn" onclick="hbInsertHR()">â”</button>

    <!-- ë˜ëŒë¦¬ê¸° -->
    <button class="toolbar-btn" onclick="hbExec('undo')">â†º</button>
    <button class="toolbar-btn" onclick="hbExec('redo')">â†»</button>

  </div>

  <!-- ë³¸ë¬¸ -->
  <div id="editor" contenteditable="true"></div>

  <!-- í•˜ë‹¨ ëª©ë¡/ë©”ì¸ -->
  <div class="notice-buttons">
    <a href="list.html"  class="btn-top">ëª©ë¡</a>
    <a href="index.html" class="btn-top">ë©”ì¸</a>
  </div>

</div>

<!-- ì—”ì§„ 4ëŒ€ ëª¨ë“ˆ -->
<script src="color.js"></script>
<script src="toolbar.js"></script>
<script src="image.js"></script>

<script>
/* ---------------------------------------------
   ğŸ“Œ localStorage ê¸°ë°˜ ê¸€ ì €ì¥/ìˆ˜ì •/ì‚­ì œ
---------------------------------------------- */
let posts = JSON.parse(localStorage.getItem("habin_posts") || "[]");
const params = new URLSearchParams(window.location.search);
const editId = params.get("id");

/* ìˆ˜ì • ëª¨ë“œì¼ ë•Œ ê¸°ì¡´ ê¸€ ë¶ˆëŸ¬ì˜¤ê¸° */
if (editId) {
  const post = posts.find(p => String(p.id) === String(editId));
  if (post) {
    document.getElementById("post-title").value = post.title || "";
    document.getElementById("editor").innerHTML = post.content || "";
    document.getElementById("notice-check").checked = !!post.isNotice;
  }
}

/* ë“±ë¡/ìˆ˜ì • */
function saveOrUpdate() {
  const title   = document.getElementById("post-title").value.trim();
  const content = document.getElementById("editor").innerHTML.trim();
  const isNotice = document.getElementById("notice-check").checked;

  if (!title) {
    alert("ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.");
    return;
  }

  const now = new Date();
  const d = `${now.getFullYear()}-${now.getMonth()+1}-${now.getDate()} ` +
            `${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`;

  if (editId) {
    const post = posts.find(p => String(p.id) === String(editId));
    if (post) {
      post.title   = title;
      post.content = content;
      post.date    = d;
      post.isNotice = isNotice;
    }
  } else {
    posts.push({
      id: Date.now(),
      title,
      content,
      writer: "í•˜ë¹ˆ",
      date: d,
      isNotice
    });
  }

  localStorage.setItem("habin_posts", JSON.stringify(posts));
  location.href = "list.html";
}

document.getElementById("saveBtn").onclick   = saveOrUpdate;
document.getElementById("updateBtn").onclick = saveOrUpdate;

/* ì‚­ì œ */
document.getElementById("deleteBtn").onclick = () => {
  if (!editId) return;
  if (!confirm("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

  posts = posts.filter(p => String(p.id) !== String(editId));
  localStorage.setItem("habin_posts", JSON.stringify(posts));
  location.href = "list.html";
};

/* ì·¨ì†Œ */
document.getElementById("cancelBtn").onclick = () => history.back();
</script>

</body>
</html>



