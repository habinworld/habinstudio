<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>í•˜ë¹ˆ ìŠ¤íŠœë””ì˜¤ Â· ê²Œì‹œíŒ ëª©ë¡</title>

  <!-- ê³µí†µ ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="style.css">

  <!-- âœ… ì¹´ë“œë·°(ê·¸ë¦¬ë“œ) ìŠ¤íƒ€ì¼ -->
  <link rel="stylesheet" href="main-grid.css">

  <style>
    /* ì „ì²´ ë ˆì´ì•„ì›ƒ */
    .page-container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 20px;
    }
    /* --------------------- í˜ì´ì§€ íƒ€ì´í‹€--------------------- */
    .page-title {
     font-size: 25px;
     font-weight: 700;
     margin: 0 0 12px 0;
     }    
    /* --------------------- ìƒë‹¨ ë²„íŠ¼ 3ê°œ--------------------- */
    .top-buttons {
      text-align: right;
      margin: 12px 0;
    }

    .top-buttons .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 6px 12px;           /* âœ… í•˜ë¹ˆ ë²„íŠ¼ ê·œê²© */
      background: #3558A8;         /* âœ… ì€ë‚¨ìƒ‰ */
      color: #FFFFFF;
      border-radius: 6px;
      font-size: 15px;             /* âœ… 15px */
      font-weight: 600;
      text-decoration: none;
      margin-left: 6px;
    }

    .top-buttons .btn:hover { opacity: 0.92; }

    /* --------------------- í…Œì´ë¸” --------------------- */
    .post-table {
      width: 100%;
      border-collapse: collapse;
      border-top: 2px solid #333;
      margin-top: 10px;
    }

    .post-table th {
      text-align: center;
      padding: 12px 0;
      border-bottom: 2px solid #ddd;
      font-size: 15px;
      color: #333;
      background: #fafafa;
    }

    .post-table td {
      padding: 6px 10px;
      border-bottom: none;
      font-size: 14px;
      color: #444;
    }

    .post-table td:nth-child(1),
    .post-table td:nth-child(2) {
      text-align: center;
    }

    .post-table td:nth-child(4) {
      text-align: right;
      color: #777;
      font-size: 14px;
    }

    .title-link {
      display: block;
      text-align: left;
      font-weight: 600;
      color: #2b2b2b;
      transition: 0.2s;
    }

    .title-link:hover { color: #3558A8; }

    .post-table a,
    .post-table a:visited,
    .post-table a:focus,
    .post-table a:hover {
      text-decoration: none ;
    }

    .notice-row { background: #FFF8D1; }

    .post-table tbody tr:hover { background: #f2f6ff; }

    .empty {
      text-align: center;
      padding: 18px 0;
      color: #777;
    }

    /* --------------------- í˜ì´ì§€ë„¤ì´ì…˜ --------------------- */
    .pagination {
      margin: 18px 0 8px;
      display: flex;
      gap: 6px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .page-btn {
      padding: 6px 12px;
      border-radius: 6px;
      background: #fff;
      border: 1px solid #d0d7ea;
      color: #3558A8;
      font-size: 15px;
      font-weight: 600;
      text-decoration: none;
    }

    .page-btn.active {
      background: #3558A8;
      color: #fff;
      border-color: #3558A8;
    }
    .admin-only {
     display: none;
     }
    /* --------------------- ì¹´ë“œë·° ì˜ì—­ --------------------- */
    .grid-floor {
      margin-top: 28px;
    }
  </style>
</head>

<body class="list-page">

  <!-- ë‚ ì§œ ìœ í‹¸ -->
  <script src="date-utils.js"></script>

  <div class="page-container">
    <h1 class="page-title">ğŸ“š í•œê¸€ ê²Œì‹œíŒ</h1>

    <div class="top-buttons">
      <a href="post.html?mode=new" class="btn">ê¸€ì“°ê¸°</a>
      <a href="list.html" class="btn">ëª©ë¡</a>
      <a href="index.html" class="btn">ë©”ì¸</a>
    </div>

    <!-- ===================== í…Œì´ë¸” ===================== -->
    <table class="post-table">
      <thead>
        <tr>
          <th class="admin-only" style="width:120px;">ê´€ë¦¬</th> <!-- âœ… ë§¨ ì• -->
          <th style="width:60px;">ë²ˆí˜¸</th>
          <th style="width:120px;">ì‘ì„±ì</th>
          <th>ì œëª©</th>
          <th style="width:150px;">ë‚ ì§œ</th>
        </tr>
      </thead>
      <tbody id="post-list"></tbody>
    </table>

    <!-- ===================== í˜ì´ì§€ë„¤ì´ì…˜ ===================== -->
    <div id="pagination" class="pagination"></div>

    <!-- ===================== ì¹´ë“œë·°(ê·¸ë¦¬ë“œ) ===================== -->
    <div class="grid-floor">
      <div id="current-exhibit" class="main-grid"></div>
    </div>
  </div>

  <!-- ì¹´ë“œë·° ì—”ì§„ -->
  <script src="main-grid.js"></script>

  <script>
    /* ğŸ—‚ localStorageì—ì„œ ê¸€ ëª©ë¡ ë¡œë“œ */
    let posts = JSON.parse(localStorage.getItem("habin_posts") || "[]");

    /* ğŸ”” ê³µì§€ + ì¼ë°˜ê¸€ ë¶„ë¦¬ (ê³µì§€ ìš°ì„ ) */
    const noticePosts = posts.filter(p => p.isNotice)
      .sort((a, b) => new Date(b.date) - new Date(a.date));

    const normalPosts = posts.filter(p => !p.isNotice)
      .sort((a, b) => new Date(b.date) - new Date(a.date));

    posts = [...noticePosts, ...normalPosts];

    const itemsPerPage = 8;

    let currentPage = new URLSearchParams(window.location.search).get("page") || 1;
    currentPage = parseInt(currentPage, 8);
    if (!currentPage || currentPage < 1) currentPage = 1;

    /* ğŸ“Œ í˜„ì¬ í˜ì´ì§€ ê¸€ ì¶”ì¶œ (ë‹¨ì¼ ì§„ì‹¤) */
    function getCurrentPagePosts() {
      const start = (currentPage - 1) * itemsPerPage;
      return posts.slice(start, start + itemsPerPage);
    }

    /* ğŸ“Œ í…Œì´ë¸” ë Œë” */
    function renderList() {
      const pagePosts = getCurrentPagePosts();
      const tbody = document.getElementById("post-list");
      tbody.innerHTML = "";

      if (pagePosts.length === 0) {
        tbody.innerHTML = `<tr><td colspan="4" class="empty">ì‘ì„±ëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
        return;
      }

      pagePosts.forEach((p, idx) => {
        const tr = document.createElement("tr");

        tr.innerHTML = `
          <!-- âœ… ê´€ë¦¬ì ì—´ (ë²ˆí˜¸ ì™¼ìª½) -->
       <td class="admin-only" style="text-align:center; white-space:nowrap;">
       <input type="checkbox"
        ${p.isMain ? "checked" : ""}
        onchange="toggleMain(${idx})"> M

       <input type="checkbox"
        ${p.isNotice ? "checked" : ""}
        onchange="toggleNotice(${idx})"> N

       <button onclick="moveUp(${idx})">â–²</button>
      <button onclick="moveDown(${idx})">â–¼</button>
      </td>
          <!-- ë²ˆí˜¸ -->
          <td>${posts.length - ((currentPage - 1) * itemsPerPage + idx)}</td>
          <td>${p.writer || "í•˜ë¹ˆ"}</td>
          <td>
            <a href="post.html?mode=view&id=${p.id}" class="title-link">
              ${p.isNotice ? "ğŸ“Œ " : ""}${p.title}
            </a>
          </td>
          <td>${formatDate(p.date)}</td>
        `;

        if (p.isNotice) tr.classList.add("notice-row");
        tbody.appendChild(tr);
      });
    }

    /* ğŸ“Œ í˜ì´ì§€ë„¤ì´ì…˜ */
    function renderPagination() {
      const totalPages = Math.ceil(posts.length / itemsPerPage);
      const pag = document.getElementById("pagination");
      pag.innerHTML = "";

      if (totalPages <= 1) return;

      if (currentPage > 1) {
        pag.innerHTML += `<a href="?page=${currentPage - 1}" class="page-btn">ì´ì „</a>`;
      }

      for (let i = 1; i <= totalPages; i++) {
        pag.innerHTML += `<a href="?page=${i}" class="page-btn ${i === currentPage ? "active" : ""}">${i}</a>`;
      }

      if (currentPage < totalPages) {
        pag.innerHTML += `<a href="?page=${currentPage + 1}" class="page-btn">ë‹¤ìŒ</a>`;
      }
    }

    /* ğŸ“Œ ì¹´ë“œë·° ë Œë” (íŒë‹¨ì€ ë¦¬ìŠ¤íŠ¸, ì¶œë ¥ë§Œ ê·¸ë¦¬ë“œ) */
    function renderGrid() {
      if (typeof renderMainGrid === "function") {
        renderMainGrid(getCurrentPagePosts());
      }
    }

    renderList();
    renderPagination();
    renderGrid();
  </script>

</body>
</html>

  



