<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í•˜ë¹ˆ ìŠ¤íŠœë””ì˜¤ Â· ê¸€ ë³´ê¸°</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<!-- ğŸ” ë¹„ë°€ì˜ ë¬¸ -->
<script src="secret-gate.js"></script>

<div class="page-container">

  <a href="list.html" class="back-btn">â† ëª©ë¡ìœ¼ë¡œ</a>

  <h1 id="post-title" class="view-title"></h1>

  <div class="view-meta">
    <span id="post-writer"></span> Â· 
    <span id="post-date"></span>
  </div>

  <hr class="divider">

  <div id="post-content" class="view-content">
    <!-- ë³¸ë¬¸ HTMLì´ ì—¬ê¸°ì— ë“¤ì–´ê° -->
  </div>

  <hr class="divider">

  <div class="view-actions">
    <button id="editBtn" class="view-btn">âœ ìˆ˜ì •</button>
    <button id="deleteBtn" class="view-btn delete">ğŸ—‘ ì‚­ì œ</button>
  </div>

  <div class="nav-box">
    <div id="prev-post" class="nav-link"></div>
    <div id="next-post" class="nav-link"></div>
  </div>

</div>

<script>
/* -------------------------------------------------------
   ğŸ“Œ URLì—ì„œ id ë°›ê¸°
------------------------------------------------------- */
const params = new URLSearchParams(location.search);
const id = parseInt(params.get("id"));

/* -------------------------------------------------------
   ğŸ“Œ ì €ì¥ëœ ê¸€ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
------------------------------------------------------- */
let posts = JSON.parse(localStorage.getItem("habin_posts") || "[]");
posts.sort((a,b)=>a.id - b.id);  // id ë‚®ì€ê²Œ ë¨¼ì € â†’ ë°°ì—´ ê¸°ì¤€ ê³ ì •

const post = posts.find(p => p.id === id);

if (!post) {
  document.body.innerHTML = "<h2>ê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</h2>";
}

/* -------------------------------------------------------
   ğŸ“Œ ë³¸ë¬¸ ì¶œë ¥
------------------------------------------------------- */
document.getElementById("post-title").innerText = post.title;
document.getElementById("post-writer").innerText = post.writer;
document.getElementById("post-date").innerText = post.date;
document.getElementById("post-content").innerHTML = post.content;


/* -------------------------------------------------------
   ğŸ“Œ ìˆ˜ì • ë²„íŠ¼ â†’ editor.html?id=ID ì´ë™
------------------------------------------------------- */
document.getElementById("editBtn").onclick = () => {
  location.href = `editor.html?id=${id}`;
};


/* -------------------------------------------------------
   ğŸ“Œ ì‚­ì œ ë²„íŠ¼ â†’ localStorageì—ì„œ ì œê±°
------------------------------------------------------- */
document.getElementById("deleteBtn").onclick = () => {
  if (!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

  const filtered = posts.filter(p => p.id !== id);
  localStorage.setItem("habin_posts", JSON.stringify(filtered));

  alert("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
  location.href = "list.html";
};


/* -------------------------------------------------------
   ğŸ“Œ ì´ì „ê¸€ / ë‹¤ìŒê¸€ ìë™ íƒìƒ‰
------------------------------------------------------- */
const idx = posts.findIndex(p => p.id === id);
const prev = posts[idx - 1];
const next = posts[idx + 1];

const prevBox = document.getElementById('prev-post');
const nextBox = document.getElementById('next-post');

if (prev) {
  prevBox.innerHTML = `â¬… ì´ì „ê¸€: <a href="view.html?id=${prev.id}">${prev.title}</a>`;
}

if (next) {
  nextBox.innerHTML = `â¡ ë‹¤ìŒê¸€: <a href="view.html?id=${next.id}">${next.title}</a>`;
}

</script>

</body>
</html>

